<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MY APP</title>
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.0/jquery-ui.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link href="sytlesheets/inicio.css" rel="stylesheet">
</head>
<body>
    {{>barranav}}
<p class="cerote">{{usuario}}</p>

{{#each posts}}
    <div class="postContenedorPrin">
        {{#if this.liked}}
            <form action="javascript:;" onsubmit="favorito({{this.id}},{{usuario}});" >
                <input id='likeB{{this.id}}' type="submit" value="unlike" class="btnDLike posCorazon">
            </form>
        {{/if}}
        {{#unless this.liked}}
            <form action="javascript:;" onsubmit="favorito({{this.id}},{{usuario}});" >
                <input id='likeB{{this.id}}' type="submit" value="like" class="btnLike posCorazon">
            </form>
        {{/unless}}
        <p>{{this.id}}</p>
        <p>{{this.Descripcion}}</p>
        <img src="http://localhost:8080/photo/{{this.id}}" alt="your image" class="imagenPost"/>
    </div>
{{/each}}
<style>
    .btnDLike {
        background: url("icons/heartSelected.png");
        background-size: cover;
        font-size: 0;
        border: 0;
        display: block;
        height: 34px;
        width: 34px;
    }
    .btnDLike:hover{
        background: url("icons/heart.png");
        background-size: cover;
        font-size: 0;
        border: 0;
        display: block;
        height: 34px;
        width: 34px;
    }
    .btnLike {
        background: url("icons/heart.png");
        background-size: cover;
        font-size: 0;
        border: 0;
        display: block;
        height: 34px;
        width: 34px;
    }
    .btnLike:hover{
        background: url("icons/heartSelected.png");
        background-size: cover;
        font-size: 0;
        border: 0;
        display: block;
        height: 34px;
        width: 34px;
    }
</style>
</body>
</html>
<script>
    function readURL(input) {
        console.log('elpapu')
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#blah')
                        .attr('src', e.target.result)
                        .width(150)
                        .height(200);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
    async function favorito(id,usuario){
        const likebtn = document.getElementById('likeB'+id);
        let caca;
        await fetch('http://localhost:8080/favorito', {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ "fotoo": id, "usuario": {{usuario}} })
        }).then(response => response.json())
                .then(response => {
                    caca = response
                })
        if (caca.resu==1) {
            likebtn.value = 'like';
            likebtn.className = 'btnLike posCorazon';
            console.log('dislike')
        }
        if (caca.resu==2) {
            likebtn.value = 'unlike';
            likebtn.className = 'btnDLike posCorazon';
            console.log('like')
        }
    }

</script>
